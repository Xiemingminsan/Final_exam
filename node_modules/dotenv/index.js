const fs = require('fs')
const path = require('path')

function config(options = {}) {
  const envPath = options.path || path.join(process.cwd(), '.env')
  if (!fs.existsSync(envPath)) return { parsed: {} }
  const content = fs.readFileSync(envPath, 'utf8')
  const lines = content.split(/\r?\n/)
  const parsed = {}
  for (const line of lines) {
    if (!line || line.trim().startsWith('#')) continue
    const [key, ...rest] = line.split('=')
    const value = rest.join('=').trim()
    parsed[key.trim()] = value
    process.env[key.trim()] = value
  }
  return { parsed }
}

module.exports = { config }
